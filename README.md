This code was written 6 month ago, do not blame me. 